<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0234: Jingle File Transfer</title><link rel="stylesheet" type="text/css" href="../xmpp.css" /><link href="../prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="../prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="Jingle File Transfer" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Creator" content="Lance Stout" /><meta name="DC.Description" content="This specification defines a Jingle application type for transferring a file from one entity to another. The protocol provides a modular framework that enables the exchange of information about the file to be transferred as well as the negotiation of parameters such as the transport to be used." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2015-09-08" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0234" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 - 2014 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0234: Jingle File Transfer</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This specification defines a Jingle application type for transferring a file from one entity to another. The protocol provides a modular framework that enables the exchange of information about the file to be transferred as well as the negotiation of parameters such as the transport to be used.</td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Peter Saint-Andre, Lance Stout</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 - 2014 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Experimental</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>0.17</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2015-09-08</td></tr></table><hr /><p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems are advised to carefully consider whether it is appropriate to deploy implementations of this protocol before it advances to a status of Draft.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#sect-idm111158242400">Requirements</a><br />3.  <a href="#terms">Terminology</a><br />4.  <a href="#sect-idm111158179264">Jingle Conformance</a><br />   
      4.1.  <a href="#content-senders">Use of Jingle Content Senders</a><br />5.  <a href="#sect-idm111158143760">Application Format</a><br />6.  <a href="#sect-idm111158075120">Negotiating a Jingle File Transfer Session</a><br />   
      6.1.  <a href="#offering">Offering a File</a><br />   
      6.2.  <a href="#requesting">Requesting a File</a><br />   
      6.3.  <a href="#sect-idm111158035840">Offering or Requesting Additional Files</a><br />   
      6.4.  <a href="#range">Ranged Transfers</a><br />   
      6.5.  <a href="#sect-idm111158025776">Aborting a Transfer</a><br />   
      6.6.  <a href="#sect-idm111158016848">Ending the Session</a><br />7.  <a href="#sdp">Mapping to Session Description Protocol</a><br />8.  <a href="#sect-idm111131752928">Informational Messages</a><br />   
      8.1.  <a href="#sect-idm111131752288">Received</a><br />   
      8.2.  <a href="#hash">Checksum</a><br />9.  <a href="#errors">Errors</a><br />   
      9.1.  <a href="#file-not-available">File not Available</a><br />   
      9.2.  <a href="#file-too-large">File too Large</a><br />10.  <a href="#impl">Implementation Notes</a><br />   
      10.1.  <a href="#impl-mti">Mandatory to Implement Technologies</a><br />   
      10.2.  <a href="#impl-pref">Preference Order of Transport Methods</a><br />   
      10.3.  <a href="#impl-migration">Migration from XEP-0096</a><br />11.  <a href="#support">Determining Support</a><br />12.  <a href="#security">Security Considerations</a><br />13.  <a href="#iana">IANA Considerations</a><br />14.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      14.1.  <a href="#registrar-ns">Protocol Namespaces</a><br />   
      14.2.  <a href="#registrar-versioning">Namespace Versioning</a><br />   
      14.3.  <a href="#registrar-content">Jingle Application Formats</a><br />15.  <a href="#schema">XML Schema</a><br />   
      15.1.  <a href="#schemas-file-transfer">urn:xmpp:jingle:apps:file-transfer:4</a><br />   
      15.2.  <a href="#schema-file-transfer-errors">urn:xmpp:jingle:apps:file-transfer:errors:0</a><br />16.  <a href="#ack">Acknowledgements</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style=""><span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0166.html">Jingle (XEP-0166)</a></span>  [<a href="#nt-idm111158244032">1</a>] can be used to initiate and negotiate a wide range of peer-to-peer sessions. One session type of interest is file transfer. This document specifies an application format for negotiating Jingle file transfer sessions, where files are exchanged via any available reliable transport.</p>
<h2>2.
       <a name="sect-idm111158242400" id="sect-idm111158242400">Requirements</a></h2>
  <p class="" style=""><span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0096.html">SI File Transfer (XEP-0096)</a></span>  [<a href="#nt-idm111158237616">2</a>] was the original XMPP protocol extension for file transfer negotiation. However, that protocol has several drawbacks, most related to the <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0095.html">Stream Initiation (XEP-0095)</a></span>  [<a href="#nt-idm111158232880">3</a>] protocol on which it depends:</p>
  <ol start="" class="" style="">
    <li class="" style=""><p class="" style="">It does not enable a true, bidirectional negotiation; instead, the initiator sets the terms for the file transfer and the responder either accepts the terms or cancels the negotiation.</p></li>
    <li class="" style=""><p class="" style="">It is the only technology in the Jabber/XMPP protocol "stack" that uses <span class="ref">XEP-0095: Stream Initiation</span>. More modern technologies such as voice and video session negotiation use <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0166.html">Jingle (XEP-0166)</a></span>  [<a href="#nt-idm111158246240">4</a>], and it would be helpful if implementors could re-use the same code for all negotiation use cases.</p></li>
  </ol>
  <p class="" style="">To overcome these drawbacks, this specification defines a file transfer negotiation method that meets the following requirements:</p>
  <ul class="" style="">
    <li class="" style=""><p class="" style="">Use the session negotiation semantics from <span class="ref">XEP-0166</span>.</p></li>
    <li class="" style="">
      <p class="" style="">Use any reliable Jingle transport mechanism, including but not limited to:</p>
      <ul class="" style="">
        <li class="" style="">ICE-TCP <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc6544">TCP Candidates with Interactive Connectivity Establishment (ICE)</a></span>  [<a href="#nt-idm111158214496">5</a>]</li>
        <li class="" style="">SOCKS5 Bytestreams <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0260.html">Jingle SOCKS5 Bytestreams Transport Method (XEP-0260)</a></span>  [<a href="#nt-idm111158208912">6</a>]</li>
        <li class="" style="">In-Band Bytestreams <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0261.html">Jingle In-Band Bytestreams Transport Method (XEP-0261)</a></span>  [<a href="#nt-idm111158203376">7</a>]</li>
      </ul>
    </li>
    <li class="" style=""><p class="" style="">Define a file description format that, unlike <span class="ref">XEP-0096</span>, enables hash agility (via <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0300.html">Use of Cryptographic Hash Functions in XMPP (XEP-0300)</a></span>  [<a href="#nt-idm111158196560">8</a>]).</p></li>
    <li class="" style=""><p class="" style="">Define a clear upgrade path from SI File Transfer to Jingle File Transfer.</p></li>
  </ul>
  <p class="" style="">Note that Jingle file transfer is only as reliable as the transports on which it depends. In particular, SOCKS5 Bytestreams ("S5B") does not always result in NAT or firewall traversal. To work around that problem, this specification requires all implementations to support as a fallback mechanism In-Band Bytestreams ("IBB"), which usually results in a successful (if slow) file transfer. A more robust and adaptable option is ICE-TCP (RFC 6455); at the time of writing <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0176.html">Jingle ICE-UDP Transport Method (XEP-0176)</a></span>  [<a href="#nt-idm111158188768">9</a>] is being updated to include the ability to negotiate ICE-TCP candidates.</p>
<h2>3.
       <a name="terms" id="terms">Terminology</a></h2>
  <div class="indent"><dl>
    <di>
      <dt><strong>File Offer</strong></dt>
      <dd>A Jingle File Transfer Content is said to be a File Offer if the content creator is the same as the content sender (see <a href="#content-senders">Use of Jingle Content Senders</a>).</dd>
    </di>
    <di>
      <dt><strong>File Request</strong></dt>
      <dd>A Jingle File Transfer Content is said to be a File Request if the content creator is the opposite of the content sender (see <a href="#content-senders">Use of Jingle Content Senders</a>).</dd>
    </di>
    <di>
      <dt><strong>File Sender</strong></dt>
      <dd>The File Sender is the side of the Jingle session responsible for sending the file data. The File Sender is not necessarily the same entity as the Jingle session initiator, and an entity could be both a File Sender and File Receiver in the context of a single Jingle session with multiple files.</dd>
    </di>
    <di>
      <dt><strong>File Receiver</strong></dt>
      <dd>The File Receiver is the side of the Jingle session responsible for receiving the file data. The File Receiver is not necessarily the same entity as the Jingle session responder, and an entity could be both a File Receiver and File Sender in the context of a single Jingle session with multiple files.</dd>
    </di>
  </dl></div>
<h2>4.
       <a name="sect-idm111158179264" id="sect-idm111158179264">Jingle Conformance</a></h2>
  <p class="" style="">In accordance with Section 12 of <span class="ref">XEP-0166</span>, this document specifies the following information related to the Jingle File Transfer ("Jingle FT") application type:</p>
  <ol start="" class="" style="">
    <li class="" style=""><p class="" style="">The application format negotiation process is defined in the <a href="#negotiation">Negotiating a Jingle File Transfer Session</a> section of this document.</p></li>
    <li class="" style=""><p class="" style="">The semantics of the &lt;description/&gt; element are defined in the <a href="#format">Application Format</a> section of this document.</p></li>
    <li class="" style=""><p class="" style="">A mapping of Jingle semantics to the Session Description Protocol is provided in the <a href="#sdp">Mapping to Session Description Protocol</a> section of this document.</p></li>
    <li class="" style=""><p class="" style="">A Jingle File Transfer session SHOULD use a streaming transport method, not a datagram transport method.</p></li>
    <li class="" style=""><p class="" style="">Transport components are not used in Jingle File Transfer.</p></li>
    <li class="" style="">
      <p class="" style="">Content is to be sent and received as follows:</p>
      <p class="" style="">For streaming transports, outbound content shall be encoded into packets (as defined by the transport mechanism) without any other framing mechanism and sent in succession over the transport. Incoming data received over the transport shall be processed as a stream of packets, where each packet's content payload is entirely composed of the next portion of file data to be processed.</p>
    </li>
  </ol>

  <div class="indent"><h3>4.1 <a name="content-senders" id="content-senders">Use of Jingle Content Senders</a></h3>
    <p class="" style="">Jingle File Transfer makes critical use of the 'senders' attribute of Jingle &lt;content/&gt; elements in order to specify which party is responsible for sending the described file. As such, Jingle File Transfer content MUST include a 'senders' attribute, where the allowed values are "initiator" and "responder". The semantics of the values "both" and "none" are undefined in Jingle File Transfer and thus NOT RECOMMENDED for use with Jingle File Transfer content.</p>
    <p class="" style="">In general, a Jingle File Transfer content is said to be a "File Offer" if the 'senders' attribute is the same as the role of the party adding the content to the session, and a "File Request" if the 'senders' value is the opposite role of the party adding the content.</p>
    <p class="" style="">Note: The content 'creator' attribute does <span class="em">not</span> specify who created or is sending the file, it only specifies which party to the session added the Jingle content to the session.</p>
    <div class="indent"><p class="caption"><a name="table-1" id="table-1"></a>Table 1: Distinguishing File Offers and Requests</p><table border="1" cellpadding="3" cellspacing="0">
      <tr class="body">
        <th colspan="" rowspan="">Jingle Session Role</th>
        <th colspan="" rowspan="">Content Senders</th>
        <th colspan="" rowspan="">File Transfer Type</th>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">initiator</td>
        <td colspan="" rowspan="">initiator</td>
        <td colspan="" rowspan="">File Offer</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">initiator</td>
        <td colspan="" rowspan="">responder</td>
        <td colspan="" rowspan="">File Request</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">responder</td>
        <td colspan="" rowspan="">initiator</td>
        <td colspan="" rowspan="">File Request</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">responder</td>
        <td colspan="" rowspan="">responder</td>
        <td colspan="" rowspan="">File Offer</td>
      </tr>
    </table></div>
  </div>
<h2>5.
       <a name="sect-idm111158143760" id="sect-idm111158143760">Application Format</a></h2>
  <p class="" style="">A Jingle File Transfer session is described by a content type that contains one application format and one transport method. Each &lt;content/&gt; element defines the details of a single file transfer. A Jingle negotiation MAY result in the establishment of multiple file transfers by including multiple &lt;content/&gt; elements.</p>
  <p class="" style="">The application format consists of a file description contained within a &lt;description/&gt; element qualified by the "urn:xmpp:jingle:apps:file-transfer:4" namespace (see <a href="#registrar-versioning">Namespace Versioning</a> regarding the possibility of incrementing the version number). The file description is a &lt;file/&gt; element specifying metadata such as the name of the file, media type, etc., as illustrated in the following example.</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
  &lt;file&gt;
    &lt;media-type&gt;text/plain&lt;/media-type&gt;
    &lt;name&gt;test.txt&lt;/name&gt;
    &lt;date&gt;2015-07-26T21:46:00&lt;/date&gt;
    &lt;size&gt;6144&lt;/size&gt;
    &lt;hash xmlns='urn:xmpp:hashes:1' 
          algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
  &lt;/file&gt;
&lt;/description&gt;</pre></div>
  <p class="" style="">The &lt;description/&gt; element is intended to be a child of a Jingle &lt;content/&gt; element as specified in <span class="ref">XEP-0166</span>.</p>
  <p class="" style="">The child elements of the &lt;file/&gt; element are as follows:</p>
  <div class="indent"><p class="caption"><a name="table-2" id="table-2"></a>Table 2: File Description Elements</p><table border="1" cellpadding="3" cellspacing="0">
    <tr class="body">
      <th colspan="" rowspan="">Element Name</th>
      <th colspan="" rowspan="">Description</th>
      <th colspan="" rowspan="">Inclusion</th>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">date</td>
      <td colspan="" rowspan="">UTC timestamp specifying the last modified time of the file (which MUST conform to the DateTime profile of <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles (XEP-0082)</a></span>  [<a href="#nt-idm111158126768">10</a>]).</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">desc</td>
      <td colspan="" rowspan="">A human readable description of the file. Multiple &lt;desc/&gt; elements MAY be included if different xml:lang values are specified.</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">hash</td>
      <td colspan="" rowspan="">A hash of the file content, using the &lt;hash/&gt; element defined in <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0300.html">Use of Cryptographic Hash Functions in XMPP (XEP-0300)</a></span>  [<a href="#nt-idm111158198768">11</a>] and qualifed by the 'urn:xmpp:hashes:1' namespace. Multiple hashes MAY be included for hash agility.</td>
      <td colspan="" rowspan="">REQUIRED when offering a file, otherwise OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">media-type</td>
      <td colspan="" rowspan="">The media type of the file content, which SHOULD be a valid MIME-TYPE as registered with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-idm111158110096">12</a>] (specifically, as listed at &lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;). If not specified, the content is assumed to be "application/octet-stream".</td>
      <td colspan="" rowspan="">RECOMMENDED when offering a file, otherwise OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">name</td>
      <td colspan="" rowspan="">The name of the file. The name SHOULD NOT contain characters or character sequences that would be interpreted as a directory structure by the local file system (e.g. "/", "\", "../", etc.). If any such characters or character sequences are present (possibly because the local and remote file systems use different syntax for directory structure), they SHOULD be escaped (e.g., via percent-encoding) before using the name as part of any file system operation. See <a href="#security">Security Considerations</a>.</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">size</td>
      <td colspan="" rowspan="">The length of the file's content, in bytes.</td>
      <td colspan="" rowspan="">OPTIONAL, but SHOULD be present when offering a file.</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">range</td>
      <td colspan="" rowspan="">The presence of the &lt;range/&gt; element indicates support of ranged transfers, and can be used to control where a transfer starts.</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
  </table></div>
  <p class="" style="">One or more &lt;hash/&gt; elements MUST be present when offering a file, but those elements MAY be empty if the hash has not yet been computed. If there is no computed hash value, the &lt;hash/&gt; element(s) MUST possess an 'algo' attribute specifying which hash algorithm will be used. Once a hash has been calculated by the File Sender, the File Sender SHOULD inform the File Receiver of the hash value as described in <a href="#checksum">Checksum</a>.</p>
  <p class="" style="">Additional elements MAY be included as children of the &lt;file/&gt; element to provide additional metadata about the file, such as <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0264.html">File Transfer Thumbnails (XEP-0264)</a></span>  [<a href="#nt-idm111158090160">13</a>].</p>
  <p class="" style="">The optional &lt;range/&gt; element MAY possess two attributes:</p>
  <div class="indent"><p class="caption"><a name="table-3" id="table-3"></a>Table 3: Range Element Attributes</p><table border="1" cellpadding="3" cellspacing="0">
    <tr class="body">
      <th colspan="" rowspan="">Attribute</th>
      <th colspan="" rowspan="">Description</th>
      <th colspan="" rowspan="">Inclusion</th>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">offset</td>
      <td colspan="" rowspan="">Specifies the position, in bytes, from which to start transferring file data. This defaults to zero (0) if not specified.</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">length</td>
      <td colspan="" rowspan="">Specifies the number of bytes to retrieve starting at offset. This defaults to the length of the file from offset to the end.</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
  </table></div>
  <p class="" style="">Inclusion of a &lt;range/&gt; element in a File Offer indicates support of ranged transfers for future File Requests if the transfer is interrupted and needs to be restarted.</p>
  <p class="" style="">A &lt;range/&gt; element MAY include an 'offset' attribute set to begin the transfer at a point other than the start of the file, and MAY include a 'length' attribute to request a portion of the file smaller than the remaining length of the file. If no 'offset' or 'length' attributes are present then it is the same as if no &lt;range/&gt; element was present, because the default values of the attributes would indicate a requested range of the entire file. In general, the first byte of data to be transferred is at the (zero-indexed) position specified by the 'offset' value, with a total of 'length' bytes sent.</p>
<h2>6.
       <a name="sect-idm111158075120" id="sect-idm111158075120">Negotiating a Jingle File Transfer Session</a></h2>
  <p class="" style="">In general, the process for negotiating a Jingle File Transfer session is as follows:</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
Initiator                    Responder
   |                             |
   |   session-initiate          |
   |----------------------------&gt;|
   |   ack                       |
   |&lt;----------------------------|
   |   session-accept            |
   |&lt;----------------------------|
   |   ack                       |
   |----------------------------&gt;|
   |   [optional further         |
   |    negotiation]             |
   |&lt;---------------------------&gt;|
   |   File Transfer             |
   |============================&gt;|
   |                             |</pre></div>

  <div class="indent"><h3>6.1 <a name="offering" id="offering">Offering a File</a></h3>
    <p class="" style="">To start a File Offer, the initiator sends a Jingle session-initiation request to a potential responder. The request specifies three things:</p>
    <ol start="" class="" style="">
      <li class="" style="">A content 'senders' attribute with the value of 'initiator' to indicate this is a File Offer.</li>
      <li class="" style="">An application type of "urn:xmpp:jingle:apps:file-transfer:4". In particular, the &lt;description/&gt; element contains a &lt;file/&gt; elements describing the file to be sent.</li>
      <li class="" style="">An appropriate transport method.</li>
    </ol>
    <p class="" style="">In this example, the initiator is &lt;romeo@montague.example&gt;, the responder is &lt;juliet@capulet.example&gt;, the application type is a File Offer, and the transport method is jingle-s5b (XEP-0260).</p>
    <p class="" style="">The flow is as follows.</p>
    <p class="" style="">First the initiator sends a Jingle session-initiate.</p>
    <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Initiator sends session-initiate</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='nzu25s8'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-initiate'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='851ba2'&gt;
    &lt;content creator='initiator' name='a-file-offer' senders='initiator'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;date&gt;1969-07-21T02:56:15Z&lt;/date&gt;
          &lt;desc&gt;This is a test. If this were a real file...&lt;/desc&gt;
          &lt;media-type&gt;text/plain&lt;/media-type&gt;
          &lt;name&gt;test.txt&lt;/name&gt;
          &lt;range/&gt;
          &lt;size&gt;6144&lt;/size&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
                 mode='tcp'
                 sid='vj3hs98y'&gt;
        &lt;candidate cid='hft54dqy'
                   host='192.168.4.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5086'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hutr46fe'
                   host='24.24.24.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5087'
                   priority='8258636'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">Note: Inclusion of the &lt;range/&gt; child of the &lt;file/&gt; element indicates that the initiator supports ranged transfers as described below under <a href="#range">Ranged Transfers</a>.</p>
    <p class="" style="">Note: Computing the hash of the file before sending it can slow down the process of file transfer, because the sending application needs to process the file twice. The File Sender might prefer to send the hash after the file transfer has begun, using a transport-info message as described under <a href="#hash">Checksum</a>.</p>
    <p class="" style="">The responder immediately acknowledges receipt of the Jingle session-initiate.</p>
    <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Responder acknowledges session-initiate</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='nzu25s8'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='result'/&gt;</pre></div>
    <p class="" style="">The initiator then attempts to initiate a SOCKS5 Bytestream with the responder as described in <span class="ref">XEP-0260</span> and <span class="ref">XEP-0065</span>. In the meantime, the responder returns a Jingle session-accept. In the session-accept message, the &lt;file/&gt; element MAY contain a &lt;range/&gt; element to indicate that the receiver also supports ranged transfers as described below under <a href="#range">Ranged Transfers</a>.</p>
    <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Responder sends session-accept</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='jn2vs71g'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-accept'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='851ba2'&gt;
    &lt;content creator='initiator' name='a-file-offer' senders='initiator'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;date&gt;1969-07-21T02:56:15Z&lt;/date&gt;
          &lt;desc&gt;This is a test. If this were a real file...&lt;/desc&gt;
          &lt;media-type&gt;text/plain&lt;/media-type&gt;
          &lt;name&gt;test.txt&lt;/name&gt;
          &lt;range/&gt;
          &lt;size&gt;6144&lt;/size&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
                 mode='tcp'
                 sid='vj3hs98y'&gt;
        &lt;candidate cid='ht567dq'
                   host='192.169.1.10'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='6539'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hr65dqyd'
                   host='134.102.201.180'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='16453'
                   priority='7929856'
                   type='assisted'/&gt;
        &lt;candidate cid='grt654q2'
                   host='2001:638:708:30c9:219:d1ff:fea4:a17d'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='6539'
                   priority='8257606'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">The initiator acknowledges the Jingle session-accept.</p>
    <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Initiator acknowledges session-accept</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='jn2vs71g'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='result'/&gt;</pre></div>
  </div>

  <div class="indent"><h3>6.2 <a name="requesting" id="requesting">Requesting a File</a></h3>
    <p class="" style="">If the File Sender has advertised the existence of a file that it hosts, such as by <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0358.html">Publishing Available Jingle Sessions (XEP-0358)</a></span>  [<a href="#nt-idm111158046480">14</a>], or if a previous file transfer attempt has failed and the File Receiver would like to initiate another attempt, the File Receiver can "pull" the file from the File Sender. This is done by sending a Jingle session-initiate to the File Sender which includes a &lt;content/&gt; with the 'senders' attribute set to the opposite Jingle session role of the party requesting the file (see <a href="#content-senders">Use of Jingle Content Senders</a>) and a &lt;description/&gt; element qualified by the 'urn:xmpp:jingle:apps:file-transfer:4' namespace and which includes a &lt;file/&gt; element with enough information included to form a "file selector" (see Section 5 of <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc5547">RFC 5547</a></span>  [<a href="#nt-idm111158040080">15</a>]) to identify the requested file.</p>
    <p class="caption"><a name="example-5" id="example-5"></a>Example 5. File Receiver requests hosted file</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='wsn361c3'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-initiate'
          initiator='juliet@capulet.example/yn0cl4bnw0yr3vym'
          sid='uj3b2'&gt;
    &lt;content creator='initiator' name='a-file-request' senders='responder'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
                 mode='tcp'
                 sid='xig361fj'&gt;
        &lt;candidate cid='ht567dq'
                   host='192.169.1.10'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='6539'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hr65dqyd'
                   host='134.102.201.180'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='16453'
                   priority='7929856'
                   type='assisted'/&gt;
        &lt;candidate cid='grt654q2'
                   host='2001:638:708:30c9:219:d1ff:fea4:a17d'
                   jid='juliet@capulet.example/yn0cl4bnw0yr3vym'
                   port='6539'
                   priority='8257606'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">See <a href="#file-not-available">File not Available</a> for how to respond if the requester does not have permission to request the file, or if the file cannot be found.</p>
  </div>

  <div class="indent"><h3>6.3 <a name="sect-idm111158035840" id="sect-idm111158035840">Offering or Requesting Additional Files</a></h3>
    <p class="" style="">While the Jingle File Transfer session is active, either party MAY choose to add additional files (both offers and requests) to the transfer session. To do so, a Jingle content-add action is used, as shown in the following examples.</p>
    <p class="caption"><a name="example-6" id="example-6"></a>Example 6. File Sender offers additional file</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='wsn361c9'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='content-add'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='uj3b2'&gt;
    &lt;content creator='initiator' name='additional' senders='initiator'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;name&gt;second-file.txt&lt;/name&gt;
          &lt;media-type&gt;text/plain&lt;/media-type&gt;
          &lt;size&gt;6144&lt;/size&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
                 mode='tcp'
                 sid='vj3hs98y'&gt;
        &lt;candidate cid='hft54dqy'
                   host='192.168.4.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5086'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hutr46fe'
                   host='24.24.24.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5087'
                   priority='8258636'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">The other party then acks the content-add request.</p>
    <p class="caption"><a name="example-7" id="example-7"></a>Example 7. File Receiver acks content-add request</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    id='wsn361c9'
    type='result' /&gt;</pre></div>
    <p class="" style="">At this point, the content-add request needs to be either accepted or rejected using Jingle content-accept or content-reject actions.</p>
  </div>

  <div class="indent"><h3>6.4 <a name="range" id="range">Ranged Transfers</a></h3>
    <p class="" style="">As in <span class="ref">XEP-0096</span>, a transfer can include only part of a file (e.g., to restart delivery of a truncated transfer session at a point other than the start of the file). This is done using the &lt;range/&gt; element. The usage is illustrated in the following examples.</p>
    <p class="" style="">Let us imagine that the parties negotiate a file transfer session using, say, In-Band Bytestreams. During the transfer, the recipient goes offline unexpectedly and IBB stanzas from the File Sender to the File Receiver begin to bounce. When the recipient comes back online, the File Sender could initiate a new Jingle session and specify that it wants to send all chunks after byte 270336 (which might be the 66th chunk of size 4096).</p>
    <p class="caption"><a name="example-8" id="example-8"></a>Example 8. File Sender requests session to send file, with range</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='wsn361c3'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-initiate'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='uj3b2'&gt;
    &lt;content creator='initiator' name='restart' senders='initiator'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;range offset='270336'/&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
             mode='tcp'
                 sid='vj3hs98y'&gt;
        &lt;candidate cid='hft54dqy'
                   host='192.168.4.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5086'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hutr46fe'
                   host='24.24.24.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5087'
                   priority='8258636'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  </div>

  <div class="indent"><h3>6.5 <a name="sect-idm111158025776" id="sect-idm111158025776">Aborting a Transfer</a></h3>
    <p class="" style="">At any point, either party MAY choose to abort the transfer of a single file, or end the session entirely to abort all active transfers.</p>
    <p class="" style="">When there is only a single Jingle content or if a party wishes to abort the transfer of all files in the session, a session-terminate including a Jingle reason of &lt;cancel /&gt; is sent.</p>
    <p class="caption"><a name="example-9" id="example-9"></a>Example 9. File Receiver aborts all active file transfers</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='jp2ba614'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-terminate'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;cancel /&gt;    
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">If a party chooses to abort the transfer of a single file out of several active transfers, a Jingle content-remove action is used, which MAY include a Jingle reason of &lt;cancel/&gt;, as shown in the following example.</p>
    <p class="caption"><a name="example-10" id="example-10"></a>Example 10. File Receiver aborts the transfer</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='jp2ba614'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='content-remove'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='a-file-offer' /&gt;
    &lt;reason&gt;
      &lt;cancel /&gt;    
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">The other party then acks the content-remove request.</p>
    <p class="caption"><a name="example-11" id="example-11"></a>Example 11. File Sender acks abort request</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='jp2ba614'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='result' /&gt;</pre></div>
    <p class="" style="">If after removing the content there are no other Jingle contents the session MUST be terminated as described in the next section.</p>
  </div>

  <div class="indent"><h3>6.6 <a name="sect-idm111158016848" id="sect-idm111158016848">Ending the Session</a></h3>
    <p class="" style="">Once all file content in the session has been transfered, either party MAY acknowledge receipt of the received files (see <a href="#received">Received</a>) or, if there are no other active file transfers, terminate the Jingle session with a Jingle session of &lt;success/&gt;. Preferably, sending the session-terminate is done by the last entity to finish receiving a file to ensure that all offered or requested files by either party have been completely received (up to the advertised sizes).</p>
    <p class="caption"><a name="example-12" id="example-12"></a>Example 12. File Receiver ends the session after successfully receiving all files</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='jp2ba614'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-terminate'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;success /&gt;    
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  </div>

<h2>7.
       <a name="sdp" id="sdp">Mapping to Session Description Protocol</a></h2>
  <p class="" style=""><span class="ref" style=""><a href="http://tools.ietf.org/html/rfc5547">RFC 5547</a></span>  [<a href="#nt-idm111158042272">16</a>] defines the general process for including file transfer information in SDP.</p>
  <p class="" style="">The SDP media type for Jingle File Transfer can be "message" (e.g. when used with <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc4975">RFC 4975</a></span>  [<a href="#nt-idm111158004144">17</a>]) or "application"; however, this media value is not reflected in the Jingle File Transfer application format.</p>
  <p class="" style="">Any combination of &lt;name/&gt;, &lt;size/&gt;, &lt;media-type/&gt;and &lt;hash/&gt; values MAY be used to form a "file selector" (see Section 5 of <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc5547">RFC 5547</a></span>  [<a href="#nt-idm111158009712">18</a>]), which would be mapped to SDP as follows:</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
a=file-selector [name:"&lt;name&gt;"] [size:&lt;size&gt;] [type:&lt;media-type&gt;] [hash:&lt;hash algo&gt;:&lt;hash value&gt;]</pre></div>
  <p class="" style="">(The hash value MUST be encoded as hexadecimal with each byte separated by a colon.)</p>
  <p class="" style="">The &lt;date/&gt; value is the last modified time of the file, and thus is mapped as follows:</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
a=file-date:modification:"&lt;date&gt;"</pre></div>
  <p class="" style="">Note: the format used here for &lt;date&gt; is the date-time format defined in <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc5322">RFC 5322</a></span>  [<a href="#nt-idm111157990976">19</a>].</p>
  <p class="" style="">If a range is specified, the SDP mapping requires both a start and stop offset. If no length was specified for the range, the stop offset is "*". If a length was specified, the stop offset is the &lt;range/&gt; offset value plus the length.</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
a=file-range:&lt;offset&gt;-&lt;(offset + length) | *&gt;</pre></div>
  <p class="" style="">As a full example, given the following Jingle File Transfer content description:</p>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
  &lt;file&gt;
    &lt;media-type&gt;text/plain&lt;/media-type&gt;
    &lt;name&gt;test.txt&lt;/name&gt;
    &lt;date&gt;2015-07-26T21:46:00&lt;/date&gt;
    &lt;size&gt;6144&lt;/size&gt;
    &lt;hash xmlns='urn:xmpp:hashes:1' 
          algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
    &lt;range offset='1024' /&gt;
  &lt;/file&gt;
&lt;/description&gt;</pre></div>
    <p class="" style="">The equivalent SDP would be:</p>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
a=file-selector: name:"test.txt" size:6144 type:text/plain hash:sha-1:55:2D:A7:49:93:08:52:C6:9A:E5:D2:14:1D:37:66:B1
a=file-date:modification:"26 Jul 2015 21:46:00"
a=file-range:1024-*</pre></div>
<h2>8.
       <a name="sect-idm111131752928" id="sect-idm111131752928">Informational Messages</a></h2>
  <div class="indent"><h3>8.1 <a name="sect-idm111131752288" id="sect-idm111131752288">Received</a></h3>
      <p class="" style="">Once a file has been successfully received, the recipient MAY send a Jingle session-info message indicating receipt of the complete file, which consists of a &lt;received/&gt; element qualified by the 'urn:xmpp:jingle:apps:file-transfer:4' namespace. The &lt;received/&gt; element SHOULD contain 'creator' and 'name' attributes sufficient to identify the content that was received.</p>
    <p class="caption"><a name="example-13" id="example-13"></a>Example 13. File Receiver sends ack in session-info</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='jp2ba614'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-info'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='a73sjjvkla37jfea'&gt;
    &lt;received xmlns='urn:xmpp:jingle:apps:file-transfer:4' 
              creator='initiator' 
              name='a-file-offer' /&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  </div>

  <div class="indent"><h3>8.2 <a name="hash" id="hash">Checksum</a></h3>
    <p class="" style="">At any time during the lifetime of the file transfer session, the File Sender can communicate the checksum of the file to the File Receiver.</p>
    <p class="" style="">This can be done in the session-initiate message if the File Sender already knows the checksum, as shown above in Example 3.</p>
    <p class="" style="">After the session-initiate message, this can also be done by sending a session-info message containing a &lt;checksum/&gt; element qualified by the 'urn:xmpp:jingle:apps:file-transfer:4' namespace. The &lt;checksum/&gt; element SHOULD contain 'creator' and 'name' attributes sufficient to identitfy the content the checksum belongs to.  Additionally, the &lt;checksum/&gt; element MUST contain a &lt;file/&gt; element which MUST contain at least one &lt;hash/&gt; element qualified by the 'urn:xmpp:hashes:1' namespace. Each &lt;hash/&gt; element contains a checksum of the file data produced in accordance with the hashing function specified by the 'algo' attribute, which MUST be one of the functions listed in the <span class="ref" style=""><a href="http://www.iana.org/assignments/hash-function-text-names">IANA Hash Function Textual Names Registry </a></span>  [<a href="#nt-idm111160482896">20</a>].</p>
    <p class="caption"><a name="example-14" id="example-14"></a>Example 14. Initiator sends checksum in session-info</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='kqh401b5'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-info'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='a73sjjvkla37jfea'&gt;
    &lt;checksum xmlns='urn:xmpp:jingle:apps:file-transfer:4' 
              creator='initiator' 
              name='a-file-offer'&gt;
      &lt;file&gt;
        &lt;hash xmlns='urn:xmpp:hashes:1' 
              algo='sha-1'&gt;552da749930852c69ae5d2141d3766b1&lt;/hash&gt;
      &lt;/file&gt;
    &lt;/checksum&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">If a ranged transfer was requested, the &lt;file/&gt; element inside the &lt;checksum/&gt; element MAY include a &lt;range/&gt; element specifying the offset and length of the requested range, which in turn includes &lt;hash/&gt; element(s) with hashes of the data that was transferred for that range.</p>
    <p class="caption"><a name="example-15" id="example-15"></a>Example 15. Initiator sends checksum in session-info for a specific range</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='kqh401b5'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-info'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='a73sjjvkla37jfea'&gt;
    &lt;checksum xmlns='urn:xmpp:jingle:apps:file-transfer:4' 
              creator='initiator' 
              name='a-file-offer'&gt;
      &lt;file&gt;
        &lt;range offset='2048' length='1024'&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' 
                algo='sha-1'&gt;4df403604e746f15062ffdbc29367886&lt;/hash&gt;
        &lt;/range&gt;
      &lt;/file&gt;
    &lt;/checksum&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">If the initiator wishes to communicate only the hashing algorithm at the beginning of the session (e.g., because it has not yet calculated the checksum), it can send an empty &lt;hash/&gt; element (without a checksum in the XML character data as shown in the previous examples) in the session-initiate message; this enables the recipient to check the file during the transfer session (which can be helpful in the case of transfers that are truncated or fail mid-stream).</p>
    <p class="caption"><a name="example-16" id="example-16"></a>Example 16. Initiator communicates hashing algorithm in session-initiate</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='nzu25s8'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-initiate'
          initiator='romeo@montague.example/dr4hcr0st3lup4c'
          sid='851ba2'&gt;
    &lt;content creator='initiator' name='a-file-offer' senders='initiator'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:file-transfer:4'&gt;
        &lt;file&gt;
          &lt;date&gt;1969-07-21T02:56:15Z&lt;/date&gt;
          &lt;desc&gt;This is a test. If this were a real file...&lt;/desc&gt;
          &lt;media-type&gt;text/plain&lt;/media-type&gt;
          &lt;name&gt;test.txt&lt;/name&gt;
          &lt;range/&gt;
          &lt;size&gt;6144&lt;/size&gt;
          &lt;hash xmlns='urn:xmpp:hashes:1' algo='sha-1'/&gt;
        &lt;/file&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:s5b:1'
                 mode='tcp'
                 sid='vj3hs98y'&gt;
        &lt;candidate cid='hft54dqy'
                   host='192.168.4.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5086'
                   priority='8257636'
                   type='direct'/&gt;
        &lt;candidate cid='hutr46fe'
                   host='24.24.24.1'
                   jid='romeo@montague.example/dr4hcr0st3lup4c'
                   port='5087'
                   priority='8258636'
                   type='direct'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  </div>
<h2>9.
       <a name="errors" id="errors">Errors</a></h2>
  <div class="indent"><h3>9.1 <a name="file-not-available" id="file-not-available">File not Available</a></h3>
    <p class="" style="">If a requested file cannot be found (or the requester does not have permission to request or know about the existence of the file in question), then the File Sender SHOULD send either a session-terminate or content-reject action in response to the session-initiate or content-add request, and SHOULD include a Jingle reason of &lt;failed-application/&gt; and MAY include an application specific reason of a &lt;file-not-available/&gt; element qualified by the 'urn:xmpp:jingle:apps:file-transfer:errors:0' namespace.</p>
     <p class="caption"><a name="example-17" id="example-17"></a>Example 17. File Sender rejects file request because the file could not be found</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='wsn361c9'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='content-reject'
          sid='uj3b2'&gt;
    &lt;content creator='initiator' name='requesting-file' senders='initiator'&gt;
    &lt;reason&gt;
      &lt;failed-application /&gt;
      &lt;file-not-available xmlns='urn:xmpp:jingle:apps:file-transfer:errors:0' /&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  </div>

  <div class="indent"><h3>9.2 <a name="file-too-large" id="file-too-large">File too Large</a></h3>
    <p class="" style="">There are several situations where a File Receiver might wish to abort a transfer due to an excess of file data, for example:</p>
    <ul class="" style="">
        <li class="" style="">The File Receiver has reached a file system storage quota or other hard limit that prevents continuing to receive file data.</li>
        <li class="" style="">The File Sender has continued sending data past the initially specified size of the file.</li>
    </ul>
    <p class="" style="">In such cases, the File Receiver MAY abort the transfer by sending a Jingle session-terminate (or content-remove as appropriate) which includes a Jingle reason of &lt;media-error/&gt; and MAY include an application specific reason of a &lt;file-too-large/&gt; element qualified by the 'urn:xmpp:jingle:apps:file-transfer:errors:0' namespace.</p>
     <p class="caption"><a name="example-18" id="example-18"></a>Example 18. File Sender rejects file request because the file could not be found</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='wsn361c9'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='content-remove'
          sid='uj3b2'&gt;
    &lt;content creator='initiator' name='big-file' senders='initiator'&gt;
    &lt;reason&gt;
      &lt;media-error /&gt;
      &lt;file-too-large xmlns='urn:xmpp:jingle:apps:file-transfer:errors:0' /&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;</pre></div>
  <p class="" style="">To prevent denial of service and other attacks, the File Receiver is fully within its rights to drop received data or not send a session-terminate message.</p>
  </div>
<h2>10.
       <a name="impl" id="impl">Implementation Notes</a></h2>
  <div class="indent"><h3>10.1 <a name="impl-mti" id="impl-mti">Mandatory to Implement Technologies</a></h3>
    <p class="" style="">All implementations MUST support the Jingle In-Band Bytestreams Transport Method (<span class="ref">XEP-0261</span>) as a reliable method of last resort. An implementation SHOULD support other transport methods as well, especially ICE-TCP (RFC 6455) and the Jingle SOCKS5 Bytestreams Transport Method (<span class="ref">XEP-0260</span>).</p>
  </div>
  <div class="indent"><h3>10.2 <a name="impl-pref" id="impl-pref">Preference Order of Transport Methods</a></h3>
    <p class="" style="">An application MAY present transport methods in any order, except that the Jingle In-Band Bytestreams Transport Method MUST be the lowest preference.</p>
  </div>
  <div class="indent"><h3>10.3 <a name="impl-migration" id="impl-migration">Migration from XEP-0096</a></h3>
    <p class="" style="">Support for Jingle file transfer can be determined through discovery of the 'urn:xmpp:jingle:apps:file-transfer:4' namespace (see <a href="#registrar-versioning">Namespace Versioning</a> regarding the possibility of incrementing the version number), via either service discovery (<span class="ref">XEP-0030</span>) or entity capabilities (<span class="ref">XEP-0115</span>). If the initiator knows that the responder supports Jingle file transfer, it SHOULD first attempt negotiation using Jingle rather than Stream Initiation.</p>
  </div>
<h2>11.
       <a name="support" id="support">Determining Support</a></h2>
  <p class="" style="">To advertise its support for the Jingle File Transfer, when replying to service discovery information ("disco#info") requests an entity MUST return URNs for any version of this protocol that the entity supports -- e.g., "urn:xmpp:jingle:apps:file-transfer:4" for this version (see <a href="#registrar-versioning">Namespace Versioning</a> regarding the possibility of incrementing the version number).</p>
  <p class="caption"><a name="example-19" id="example-19"></a>Example 19. Service discovery information request</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@montague.example/dr4hcr0st3lup4c'
    id='uw72g176'
    to='juliet@capulet.example/yn0cl4bnw0yr3vym'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;</pre></div>
  <p class="caption"><a name="example-20" id="example-20"></a>Example 20. Service discovery information response</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@capulet.example/yn0cl4bnw0yr3vym'
    id='uw72g176'
    to='romeo@montague.example/dr4hcr0st3lup4c'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;feature var='urn:xmpp:jingle:1'/&gt;
    &lt;feature var='urn:xmpp:jingle:apps:file-transfer:4'/&gt;
    &lt;feature var='urn:xmpp:jingle:transports:s5b:1'/&gt;
    &lt;feature var='urn:xmpp:jingle:transports:ibb:1'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;</pre></div>
  <p class="" style="">In order for an application to determine whether an entity supports this protocol, where possible it SHOULD use the dynamic, presence-based profile of service discovery defined in <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0115.html">Entity Capabilities (XEP-0115)</a></span>  [<a href="#nt-idm111160445792">21</a>]. However, if an application has not received entity capabilities information from an entity, it SHOULD use explicit service discovery instead.</p>
<h2>12.
       <a name="security" id="security">Security Considerations</a></h2>
    <p class="" style="">Caution needs to be exercised when using the &lt;name/&gt; of a file offer or request to control any interaction with a file system. For example, a malicious user could request a file with &lt;name&gt;/etc/passwd&lt;/name&gt; or include file system specific control patterns such as &lt;name&gt;../../private.txt&lt;/name&gt; to try and access a sensitive file outside of the set of files intended to be shared. Or a malicious user could offer a file named "/etc/passwd" to try and trick the receiver into overwriting that or other sensitive files. Therefore, implementations SHOULD escape any file system path separators in the &lt;name/&gt; before using that value in any file system calls.</p>
  <p class="" style="">It is RECOMMENDED for implementations to use the strongest hashing algorithm available to both parties. See <span class="ref">XEP-0300</span> for further discussion.</p>
  <p class="" style="">In order to secure the data stream, implementations SHOULD use encryption methods appropriate to the transport method being used. For example, end-to-end encryption can be negotiated over either SOCKS5 Bytestreams or In-Band Bytestreams as described in <span class="ref">XEP-0260</span> and <span class="ref">XEP-0261</span>.</p>
  <p class="" style="">Refer to <span class="ref">XEP-0047</span>, <span class="ref">XEP-0065</span>, <span class="ref">XEP-0096</span>, <span class="ref">XEP-0176</span>, <span class="ref">XEP-0260</span>, <span class="ref">XEP-0261</span>, and <span class="ref">RFC 6455</span> for related security considerations.</p>
<h2>13.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">No interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-idm111158113200">22</a>] is required as a result of this document.</p>
  <p class="" style="">The XML character data of the &lt;media-type/&gt; element SHOULD be a value registered with the IANA in the <span class="ref" style=""><a href="http://www.iana.org/assignments/media-types">IANA MIME Media Types Registry</a></span>  [<a href="#nt-idm111160427584">23</a>].</p>
<h2>14.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <div class="indent"><h3>14.1 <a name="registrar-ns" id="registrar-ns">Protocol Namespaces</a></h3>
    <p class="" style="">This specification defines the following XML namespace:</p>
    <ul class="" style="">
      <li class="" style="">urn:xmpp:jingle:apps:file-transfer:4</li>
    </ul>
    <p class="" style="">Upon advancement of this specification from a status of Experimental to a status of Draft, the <span class="ref" style=""><a href="http://xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-idm111160417840">24</a>] shall add the foregoing namespace to the registry located at &lt;<a href="http://xmpp.org/registrar/namespaces.html">http://xmpp.org/registrar/namespaces.html</a>&gt;, as described in Section 4 of <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0053.html">XMPP Registrar Function (XEP-0053)</a></span>  [<a href="#nt-idm111160411104">25</a>].</p>
  </div>
  <div class="indent"><h3>14.2 <a name="registrar-versioning" id="registrar-versioning">Namespace Versioning</a></h3>
    <p class="" style="">If the protocol defined in this specification undergoes a revision that is not fully backwards-compatible with an older version, the XMPP Registrar shall increment the protocol version number found at the end of the XML namespaces defined herein, as described in Section 4 of <span class="ref">XEP-0053</span>.</p>
  </div>
  <div class="indent"><h3>14.3 <a name="registrar-content" id="registrar-content">Jingle Application Formats</a></h3>
    <p class="" style="">The XMPP Registrar shall include "file-transfer" in its registry of Jingle application formats. The registry submission is as follows:</p>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;application&gt;
  &lt;name&gt;file-transfer&lt;/name&gt;
  &lt;desc&gt;Jingle sessions for the transfer of a file&lt;/desc&gt;
  &lt;transport&gt;streaming&lt;/transport&gt;
  &lt;doc&gt;XEP-0234&lt;/doc&gt;
&lt;/application&gt;</pre></div>
  </div>
<h2>15.
       <a name="schema" id="schema">XML Schema</a></h2>

  <div class="indent"><h3>15.1 <a name="schemas-file-transfer" id="schemas-file-transfer">urn:xmpp:jingle:apps:file-transfer:4</a></h3>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:jingle:apps:file-transfer:4'
    xmlns='urn:xmpp:jingle:apps:file-transfer:4'
    elementFormDefault='qualified'&gt;

  &lt;xs:import namespace='urn:xmpp:hashes:1'/&gt;

  &lt;xs:element name='description'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:all&gt;
        &lt;xs:element name='file' type='fileTransferElementType'/&gt;
      &lt;/xs:all&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='checksum'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:all&gt;
        &lt;xs:element name='file' type='fileTransferElementType'/&gt;
      &lt;/xs:all&gt;
      &lt;xs:attribute name='creator' use='required'&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base='xs:NCName'&gt;
            &lt;xs:enumeration value='initiator'/&gt;
            &lt;xs:enumeration value='responder'/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
      &lt;/xs:attribute&gt;
      &lt;xs:attribute name='name' type='xs:string' use='required'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:complexType name='fileTransferElementType'&gt;
    &lt;xs:all xmlns:h='urn:xmpp:hashes:1' minOccurs='0'&gt;
      &lt;xs:element name='date' type='xs:date'/&gt;
      &lt;xs:element name='media-type' type='xs:string'/&gt;
      &lt;xs:element name='name' type='xs:string'/&gt;
      &lt;xs:element name='size' type='xs:positiveInteger'/&gt;
      &lt;xs:element name='range' type='fileTransferRangeType'/&gt;
      &lt;xs:element ref='h:hash' minOccurs='0' maxOccurs='unbounded'/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:complexType name='fileTransferRangeType'&gt;
    &lt;xs:attribute name='offset' type='xs:nonNegativeInteger' use='optional' default='0' /&gt;
    &lt;xs:all xmlns:h='urn:xmpp:hashes:1' minOccurs='0'&gt;
      &lt;xs:element ref='h:hash' minOccurs='0' maxOccurs='unbounded' /&gt;
    &lt;/xs:all&gt;
  &lt;/xs:complexType&gt;

&lt;/xs:schema&gt;</pre></div>
  </div>

  <div class="indent"><h3>15.2 <a name="schema-file-transfer-errors" id="schema-file-transfer-errors">urn:xmpp:jingle:apps:file-transfer:errors:0</a></h3>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:jingle:apps:file-transfer:4'
    xmlns='urn:xmpp:jingle:apps:file-transfer:errors:0'
    elementFormDefault='qualified'&gt;

  &lt;xs:element name='file-not-available' type='empty' /&gt;
  &lt;xs:element name='file-too-large' type='empty' /&gt;

&lt;/xs:schema&gt;</pre></div>
  </div>
<h2>16.
       <a name="ack" id="ack">Acknowledgements</a></h2>
  <p class="" style="">Thanks to Diana Cionoiu, Olivier Crête, Viktor Fast, Philipp Hancke, Waqas Hussain, Justin Karneges, Steffen Larsen, Yann Leboulanger, Marcus Lundblad, Robert McQueen, Joe Maissel, Glenn Maynard, Ali Sabil, Sjoerd Simons, Will Thompson, Matthew Wild, and Jiří Zárevúcky for their feedback.</p>
<hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0234<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.17<br />
            Last Updated: 2015-09-08<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XEP-0166, XEP-0261, XEP-0300<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: NOT_YET_ASSIGNED<br />
              Source Control: 
                <a class="standardsButton" href="http://gitorious.org/xmpp/xmpp/blobs/master/extensions/xep-0234.xml">HTML</a><br />
            This document in other formats: 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0234.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0234.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Peter Saint-Andre</h3><p class="indent">
        Email:
        <a href="mailto:peter@andyet.net">peter@andyet.net</a><br />
        JabberID: 
        <a href="xmpp:stpeter@stpeter.im">stpeter@stpeter.im</a><br />
        URI: 
        <a href="https://stpeter.im/">https://stpeter.im/</a><br /></p><h3>Lance Stout</h3><p class="indent">
        Email:
        <a href="mailto:lance@andyet.com">lance@andyet.com</a><br />
        JabberID: 
        <a href="xmpp:lance@lance.im">lance@lance.im</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 - 2014 by the <a href="http://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/">http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/</a>&gt; or obtained by writing to XMPP Standards Foundation, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-idm111158244032" id="nt-idm111158244032">1</a>. XEP-0166: Jingle &lt;<a href="http://xmpp.org/extensions/xep-0166.html">http://xmpp.org/extensions/xep-0166.html</a>&gt;.</p><p><a name="nt-idm111158237616" id="nt-idm111158237616">2</a>. XEP-0096: SI File Transfer &lt;<a href="http://xmpp.org/extensions/xep-0096.html">http://xmpp.org/extensions/xep-0096.html</a>&gt;.</p><p><a name="nt-idm111158232880" id="nt-idm111158232880">3</a>. XEP-0095: Stream Initiation &lt;<a href="http://xmpp.org/extensions/xep-0095.html">http://xmpp.org/extensions/xep-0095.html</a>&gt;.</p><p><a name="nt-idm111158246240" id="nt-idm111158246240">4</a>. XEP-0166: Jingle &lt;<a href="http://xmpp.org/extensions/xep-0166.html">http://xmpp.org/extensions/xep-0166.html</a>&gt;.</p><p><a name="nt-idm111158214496" id="nt-idm111158214496">5</a>. TCP Candidates with Interactive Connectivity Establishment (ICE) &lt;<a href="http://tools.ietf.org/html/rfc6544">http://tools.ietf.org/html/rfc6544</a>&gt;. Work in progress.</p><p><a name="nt-idm111158208912" id="nt-idm111158208912">6</a>. XEP-0260: Jingle SOCKS5 Bytestreams Transport Method &lt;<a href="http://xmpp.org/extensions/xep-0260.html">http://xmpp.org/extensions/xep-0260.html</a>&gt;.</p><p><a name="nt-idm111158203376" id="nt-idm111158203376">7</a>. XEP-0261: Jingle In-Band Bytestreams Transport Method &lt;<a href="http://xmpp.org/extensions/xep-0261.html">http://xmpp.org/extensions/xep-0261.html</a>&gt;.</p><p><a name="nt-idm111158196560" id="nt-idm111158196560">8</a>. XEP-0300: Use of Cryptographic Hash Functions in XMPP &lt;<a href="http://xmpp.org/extensions/xep-0300.html">http://xmpp.org/extensions/xep-0300.html</a>&gt;.</p><p><a name="nt-idm111158188768" id="nt-idm111158188768">9</a>. XEP-0176: Jingle ICE-UDP Transport Method &lt;<a href="http://xmpp.org/extensions/xep-0176.html">http://xmpp.org/extensions/xep-0176.html</a>&gt;.</p><p><a name="nt-idm111158126768" id="nt-idm111158126768">10</a>. XEP-0082: XMPP Date and Time Profiles &lt;<a href="http://xmpp.org/extensions/xep-0082.html">http://xmpp.org/extensions/xep-0082.html</a>&gt;.</p><p><a name="nt-idm111158198768" id="nt-idm111158198768">11</a>. XEP-0300: Use of Cryptographic Hash Functions in XMPP &lt;<a href="http://xmpp.org/extensions/xep-0300.html">http://xmpp.org/extensions/xep-0300.html</a>&gt;.</p><p><a name="nt-idm111158110096" id="nt-idm111158110096">12</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-idm111158090160" id="nt-idm111158090160">13</a>. XEP-0264: File Transfer Thumbnails &lt;<a href="http://xmpp.org/extensions/xep-0264.html">http://xmpp.org/extensions/xep-0264.html</a>&gt;.</p><p><a name="nt-idm111158046480" id="nt-idm111158046480">14</a>. XEP-0358: Publishing Available Jingle Sessions &lt;<a href="http://xmpp.org/extensions/xep-0358.html">http://xmpp.org/extensions/xep-0358.html</a>&gt;.</p><p><a name="nt-idm111158040080" id="nt-idm111158040080">15</a>. RFC 5547: A Session Description Protocol (SDP) Offer/Answer Mechanism to Enable File Transfer &lt;<a href="http://tools.ietf.org/html/rfc5547">http://tools.ietf.org/html/rfc5547</a>&gt;.</p><p><a name="nt-idm111158042272" id="nt-idm111158042272">16</a>. RFC 5547: A Session Description Protocol (SDP) Offer/Answer Mechanism to Enable File Transfer &lt;<a href="http://tools.ietf.org/html/rfc5547">http://tools.ietf.org/html/rfc5547</a>&gt;.</p><p><a name="nt-idm111158004144" id="nt-idm111158004144">17</a>. RFC 4975: The Message Session Relay Protocol (MSRP) &lt;<a href="http://tools.ietf.org/html/rfc4975">http://tools.ietf.org/html/rfc4975</a>&gt;.</p><p><a name="nt-idm111158009712" id="nt-idm111158009712">18</a>. RFC 5547: A Session Description Protocol (SDP) Offer/Answer Mechanism to Enable File Transfer &lt;<a href="http://tools.ietf.org/html/rfc5547">http://tools.ietf.org/html/rfc5547</a>&gt;.</p><p><a name="nt-idm111157990976" id="nt-idm111157990976">19</a>. RFC 5322: Internet Message Format &lt;<a href="http://tools.ietf.org/html/rfc5322">http://tools.ietf.org/html/rfc5322</a>&gt;.</p><p><a name="nt-idm111160482896" id="nt-idm111160482896">20</a>. IANA registry of Hash Function Textual Names &lt;<a href="http://www.iana.org/assignments/hash-function-text-names">http://www.iana.org/assignments/hash-function-text-names</a>&gt;.</p><p><a name="nt-idm111160445792" id="nt-idm111160445792">21</a>. XEP-0115: Entity Capabilities &lt;<a href="http://xmpp.org/extensions/xep-0115.html">http://xmpp.org/extensions/xep-0115.html</a>&gt;.</p><p><a name="nt-idm111158113200" id="nt-idm111158113200">22</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-idm111160427584" id="nt-idm111160427584">23</a>. IANA registry of MIME media types &lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;.</p><p><a name="nt-idm111160417840" id="nt-idm111160417840">24</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://xmpp.org/registrar/">http://xmpp.org/registrar/</a>&gt;.</p><p><a name="nt-idm111160411104" id="nt-idm111160411104">25</a>. XEP-0053: XMPP Registrar Function &lt;<a href="http://xmpp.org/extensions/xep-0053.html">http://xmpp.org/extensions/xep-0053.html</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 0.17 (2015-09-08)</h4><div class="indent">
      <ul class="" style="">
        <li class="" style="">Recast the document to match the registration procedure defined by XEP-0166 for new application types.</li>
        <li class="" style="">Explicitly defined the schema of the &lt;file/&gt; element instead of referencing XEP-0096.</li>
        <li class="" style="">Defined the use of a 'length' attribute on &lt;range/&gt; elements. This attribute was always there because the &lt;file/&gt; and &lt;range/&gt; elements had been defined as the same as the parallel elements in XEP-0096, but the 'length' attribute was not explicitly referenced in this document.</li>
        <li class="" style="">Clarified the need for the 'senders' attribute on Jingle &lt;content/&gt; elements to distinguish between File Offers and File Requests.</li>
        <li class="" style="">Added the &lt;file-not-found/&gt; and &lt;file-too-large/&gt; reason types.</li>
        <li class="" style="">Clarified how to abort a file transfer via 'content-remove' or 'session-terminate' actions.</li>
        <li class="" style="">Added &lt;received/&gt; element for indicating that a transfer was successful, particularly when there are multiple transfers.</li>
        <li class="" style="">Added SDP mapping.</li>
      </ul>
     (ls/psa)
    </div><h4>Version 0.16 (2014-08-11)</h4><div class="indent">
      <ul class="" style="">
        <li class="" style="">Modified protocol to support sending only one file at a time (multi-file adds unnecessary complexity).</li>
        <li class="" style="">Removed &lt;request/&gt; flow in favor of a dedicated protocol similar to XEP-0137 ("jingle-pub").</li>
        <li class="" style="">Removed &lt;offer/&gt; wrapper since it is no longer necessary (with the removal of the request flow).</li>
        <li class="" style="">Removed the &lt;abort/&gt; element since it was related to the transfer of multiple files.</li>
        <li class="" style="">Changed &lt;candidate-used/&gt; to &gt;remote-candidate/&gt; for consistency with XEP-0176.</li>
        <li class="" style="">Added media-type child to &lt;file/&gt; element.</li>
        <li class="" style="">Added example for communicating empty &lt;hash/&gt; element in the session-initiate message.</li>
        <li class="" style="">Incremented namespace version from 3 to 4.</li>
      </ul>
     (psa)
    </div><h4>Version 0.15 (2012-02-08)</h4><div class="indent"><p class="" style="">Updated to track revisions to XEP-0300.</p> (psa)
    </div><h4>Version 0.14 (2011-06-29)</h4><div class="indent">
      <ul class="" style="">
        <li class="" style="">Defined file description format separate from XEP-0096</li>
        <li class="" style="">Modified the checksum format to reuse the &lt;hashes/&gt; element from XEP-0300</li>
        <li class="" style="">Described the process of aborting a file transfer</li>
        <li class="" style="">Clarified the order of events (Jingle, then transport) when the session is terminated</li>
        <li class="" style="">Added section on determining spport, including service discovery feature for multi-file support</li>
        <li class="" style="">Removed the 'urn:xmpp:jingle:apps:file-transfer:info:2' namespace by putting all elements into the 'urn:xmpp:jingle:apps:file-transfer:4' namespace</li>
        <li class="" style="">Incremented namespace version from 2 to 3</li>
      </ul>
     (psa)
    </div><h4>Version 0.13 (2011-06-01)</h4><div class="indent"><p class="" style="">Added multi-file use case; updated spec to reflect XEP-0260 and XEP-0261; added algorithm attribute from XEP-0096; increased namespace versions from 1 to 2.</p> (psa)
    </div><h4>Version 0.12 (2011-01-05)</h4><div class="indent"><p class="" style="">Clarified usage of Jingle actions as well as several ambiguous points in the text, including use of the range feature from XEP-0096.</p> (psa)
    </div><h4>Version 0.11 (2010-02-19)</h4><div class="indent"><p class="" style="">Added session-info message and namespace for communicating the file hash.</p> (psa)
    </div><h4>Version 0.10 (2010-02-11)</h4><div class="indent"><p class="" style="">Described the file retrieval case; updated referenced namespaces.</p> (psa)
    </div><h4>Version 0.9 (2009-02-19)</h4><div class="indent">
      <ul class="" style="">
        <li class="" style="">Moved Jingle definitions of S5B and IBB transports to standalone documents.</li>
        <li class="" style="">Because the jingle-s5b and jingle-ibb transport methods are backward-incompatible, incremented protocol version number from 0 to 1 and changed namespace from urn:xmpp:jingle:apps:file-transfer:0 to urn:xmpp:jingle:apps:file-transfer:2.</li>
        <li class="" style="">Moved transport fallback scenario to XEP-0260.</li>
      </ul>
     (psa)
    </div><h4>Version 0.8 (2008-09-30)</h4><div class="indent"><p class="" style="">Corrected fallback scenario to use transport-replace and transport-accept.</p> (psa)
    </div><h4>Version 0.7 (2008-09-25)</h4><div class="indent">
      <ul class="" style="">
        <li class="" style="">Deleted content-replace from session flows.</li>
        <li class="" style="">Modified namespaces to incorporate namespace versioning.</li>
        <li class="" style="">Cleaned up XML schemas.</li>
      </ul>
     (psa)
    </div><h4>Version 0.6 (2008-07-31)</h4><div class="indent"><p class="" style="">Harmonized with XEP-0166; modified fallback to use transport-replace and transport-accept.</p> (psa)
    </div><h4>Version 0.5 (2008-06-05)</h4><div class="indent"><p class="" style="">Modified fallback scenario to use content-replace action during pending state.</p> (psa)
    </div><h4>Version 0.4 (2008-06-04)</h4><div class="indent"><p class="" style="">Harmonized negotiation flows with other Jingle application types.</p> (psa)
    </div><h4>Version 0.3 (2008-05-29)</h4><div class="indent"><p class="" style="">Corrected and more clearly explained negotiation flows for consistency with XEP-0166 and other Jingle specifications.</p> (psa)
    </div><h4>Version 0.2 (2008-03-20)</h4><div class="indent"><p class="" style="">Added transport negotiation scenario.</p> (psa)
    </div><h4>Version 0.1 (2008-03-05)</h4><div class="indent"><p class="" style="">Initial published version.</p> (psa)
    </div><h4>Version 0.0.3 (2008-02-29)</h4><div class="indent"><p class="" style="">Corrected use of content-replace action; specified that the In-Band Bytestreams transport method is mandatory-to-implement but must have the lowest preference order.</p> (psa)
    </div><h4>Version 0.0.2 (2008-02-28)</h4><div class="indent"><p class="" style="">Modified negotiation flow to use new content-replace action.</p> (psa)
    </div><h4>Version 0.0.1 (2008-01-29)</h4><div class="indent"><p class="" style="">First draft.</p> (psa)
    </div></div><hr /><p>END</p></body></html>
